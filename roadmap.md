# 📊 EleKnowledge-AI 開発ロードマップ

## プロジェクト情報

**プロジェクト名:** EleKnowledge-AI  
**最終更新日:** 2025-10-02  
**開始予定日:** 2025年10月  
**Phase 1完了予定:** 2025年12月  
**Phase 2完了予定:** 2026年2月  

---

## 目次

1. [プロジェクト概要](#1-プロジェクト概要)
2. [Phase 1: 基盤整備（2ヶ月）](#2-phase-1-基盤整備2ヶ月)
3. [Phase 2: RAGチャット機能（2ヶ月）](#3-phase-2-ragチャット機能2ヶ月)
4. [Phase 3: 新機能開発（3ヶ月）](#4-phase-3-新機能開発3ヶ月)
5. [マイルストーンとレビューポイント](#5-マイルストーンとレビューポイント)
6. [リスクと対策](#6-リスクと対策)

---

## 1. プロジェクト概要

### 1.1 プロジェクトゴール

生成AIと社内データを活用した検索システム・業務自動実行システムの構築

### 1.2 主要機能

- **Phase 1:** 認証基盤、ホーム画面、IP制限
- **Phase 2:** RAGチャット機能（Knowledge Base + Claude 4）
- **Phase 3:** トラブルシューティング、品質書類チェック（後日詳細策定）

### 1.3 想定ユーザー

- 同時接続: 20人
- 登録ユーザー: 100人
- 社内ネットワーク: 192.168.28.0/24

---

## 2. Phase 1: 基盤整備（2ヶ月）

### 2.1 目標

認証基盤とホスト環境の構築、IP制限の設定

### 2.2 Week 1-2: 環境構築

#### AWS環境セットアップ

**Week 1:**
- [ ] AWSアカウント設定確認
- [ ] IAMロール・ポリシー作成
  - [ ] Lambda実行ロール
  - [ ] API Gateway実行ロール
  - [ ] Amplify サービスロール
- [ ] VPC構成
  - [ ] VPC作成: eleknowledge-vpc (192.168.28.0/24)
  - [ ] Private Subnet作成
    - [ ] eleknowledge-private-1a (192.168.28.0/26)
    - [ ] eleknowledge-private-1b (192.168.28.64/26)
  - [ ] NAT Gateway設定
  - [ ] Security Group設定

**Week 2:**
- [ ] Cognito User Pool作成
  - [ ] パスワードポリシー設定
  - [ ] MFA設定（オプション）
  - [ ] メールテンプレート設定
- [ ] DynamoDBテーブル作成
  - [ ] users テーブル
  - [ ] eleknowledge-chatlogs テーブル（Phase 2で使用）
  - [ ] TTL設定
- [ ] S3バケット作成
  - [ ] eleknowledge-documents（Knowledge Base用）
  - [ ] eleknowledge-uploads（一時アップロード用）
  - [ ] バージョニング有効化
  - [ ] ライフサイクルポリシー設定

#### 開発環境セットアップ

- [ ] Gitリポジトリ作成
  - [ ] ブランチ戦略設定（main, develop）
  - [ ] `.gitignore` 設定
- [ ] Next.jsプロジェクト初期化
  - [ ] TypeScript設定
  - [ ] Tailwind CSS設定
  - [ ] shadcn/ui インストール
- [ ] 環境変数設定
  - [ ] `.env.local` 作成
  - [ ] `.env.example` 作成

**成果物:**
- ✅ AWS環境構築完了
- ✅ 開発環境構築完了

---

### 2.3 Week 3-4: 認証機能実装

#### バックエンド: 認証Lambda実装

**Week 3:**
- [ ] 認証API Gateway作成
  - [ ] Cognito Authorizer設定
  - [ ] CORS設定
  - [ ] スロットリング設定: 50 req/sec
- [ ] signup-function 実装
  - [ ] Cognito SignUp API統合
  - [ ] 入力検証
  - [ ] エラーハンドリング
  - [ ] 単体テスト作成
- [ ] login-function 実装
  - [ ] Cognito SignIn API統合
  - [ ] トークン発行
  - [ ] エラーハンドリング
  - [ ] 単体テスト作成

**Week 4:**
- [ ] verify-function 実装
  - [ ] メール確認コード検証
  - [ ] ユーザーアクティベーション
- [ ] password-reset-function 実装
  - [ ] パスワードリセットフロー
- [ ] Lambda デプロイ
  - [ ] AWS SAM / Serverless Framework設定
  - [ ] GitHub Actions CI/CD設定

#### フロントエンド: 認証画面実装

**Week 3-4:**
- [ ] 認証コンテキスト作成
  - [ ] AWS Amplify設定
  - [ ] トークン管理ロジック
  - [ ] 自動リフレッシュ実装
- [ ] サインアップ画面
  - [ ] フォームUI実装
  - [ ] React Hook Form統合
  - [ ] バリデーション
- [ ] ログイン画面
  - [ ] フォームUI実装
  - [ ] エラー表示
  - [ ] ローディング状態管理
- [ ] パスワードリセット画面
- [ ] E2Eテスト作成
  - [ ] サインアップフロー
  - [ ] ログインフロー

**成果物:**
- ✅ 認証機能完成
- ✅ テスト完了

**マイルストーン:** Week 4終了時点で認証機能デモ可能

---

### 2.4 Week 5-6: ホーム画面実装

#### フロントエンド実装

**Week 5:**
- [ ] レイアウトコンポーネント作成
  - [ ] ヘッダー
  - [ ] サイドバー（将来拡張用）
  - [ ] フッター
- [ ] ホーム画面実装
  - [ ] 機能カード3つ
    - [ ] RAGチャット（リンク有効）
    - [ ] トラブルシューティング（開発中表示）
    - [ ] 品質書類チェック（開発中表示）
  - [ ] ユーザー情報表示
  - [ ] ログアウトボタン
- [ ] ルーティング設定
  - [ ] Protected Route実装
  - [ ] 認証チェック

**Week 6:**
- [ ] レスポンシブデザイン対応
  - [ ] モバイル表示
  - [ ] タブレット表示
- [ ] アクセシビリティ対応
  - [ ] キーボードナビゲーション
  - [ ] ARIA属性
- [ ] パフォーマンス最適化
  - [ ] 画像最適化
  - [ ] コード分割

**成果物:**
- ✅ ホーム画面完成
- ✅ レスポンシブ対応完了

---

### 2.5 Week 7-8: AWS Amplify & WAF設定

#### Amplify Hosting設定

**Week 7:**
- [ ] Amplify アプリケーション作成
  - [ ] GitHubリポジトリ連携
  - [ ] ビルド設定
  - [ ] 環境変数設定
- [ ] 自動デプロイ設定
  - [ ] develop ブランチ → 開発環境
  - [ ] main ブランチ → 本番環境
- [ ] カスタムドメイン設定（オプション）

#### WAF設定

**Week 7-8:**
- [ ] WAF ACL作成
  - [ ] IP Set作成: 192.168.28.0/24
- [ ] WAFルール設定
  1. [ ] IP許可リストルール
  2. [ ] レート制限（IP単位）: 500 req/5min
  3. [ ] レート制限（全体）: 2000 req/5min
  4. [ ] SQLインジェクション防御
  5. [ ] 共通攻撃防御（AWS Managed Rules）
- [ ] Amplifyに WAF ACLアタッチ
- [ ] WAF動作テスト
  - [ ] 許可IPからのアクセステスト
  - [ ] 拒否IP からのアクセステスト
  - [ ] レート制限テスト

#### 統合テスト

**Week 8:**
- [ ] 認証フロー E2Eテスト
- [ ] IP制限テスト
- [ ] パフォーマンステスト
- [ ] セキュリティテスト
  - [ ] XSS対策確認
  - [ ] CSRF対策確認
  - [ ] 認証バイパステスト

**成果物:**
- ✅ Amplify Hosting稼働
- ✅ WAF設定完了
- ✅ IP制限動作確認完了

**Phase 1完了マイルストーン:** Week 8終了時点

---

### 2.6 Phase 1 レビューポイント

#### 完了基準

- [ ] 認証機能が正常に動作する
  - [ ] サインアップ・ログイン・ログアウト
  - [ ] パスワードリセット
- [ ] ホーム画面が表示される
- [ ] 社内IPからのみアクセス可能
- [ ] WAFルールが正常に動作する
- [ ] すべてのテストが通過する

#### レビュー会議

- **日程:** Week 8最終日
- **参加者:** 開発チーム、プロジェクトオーナー
- **議題:**
  1. Phase 1成果物デモ
  2. テスト結果報告
  3. Phase 2への移行判断
  4. 課題・改善点の共有

---

## 3. Phase 2: RAGチャット機能（2ヶ月）

### 3.1 目標

Knowledge Baseを活用したRAGチャット機能の完全実装

### 3.2 Week 9-10: Knowledge Base構築

#### ドキュメント準備

**Week 9:**
- [ ] ドキュメント収集
  - [ ] マニュアル類
  - [ ] 規定・ポリシー
  - [ ] 報告書
  - [ ] 仕様書
- [ ] ドキュメント整理
  - [ ] カテゴリ分類
  - [ ] ファイル名標準化
  - [ ] メタデータ定義
- [ ] S3にアップロード
  - [ ] ディレクトリ構造作成
  - [ ] ファイルアップロード
  - [ ] メタデータ設定

#### Knowledge Base作成

**Week 10:**
- [ ] OpenSearch Serverless作成
- [ ] Bedrock Knowledge Base作成
  - [ ] データソース設定（S3）
  - [ ] Embedding Model設定（Titan Embeddings G1）
  - [ ] メタデータフィルター設定
- [ ] Knowledge Base同期
  - [ ] 初回インデクシング実行
  - [ ] インデクシング完了確認
- [ ] Knowledge Base動作テスト
  - [ ] 検索クエリテスト
  - [ ] メタデータフィルターテスト
  - [ ] レスポンス確認

**成果物:**
- ✅ Knowledge Base構築完了
- ✅ ドキュメント検索可能

---

### 3.3 Week 11-12: RAG Lambda実装

#### バックエンド実装

**Week 11:**
- [ ] RAG処理API Gateway作成
  - [ ] Cognito Authorizer設定
  - [ ] スロットリング設定: 20 req/sec
- [ ] rag-function 実装
  - [ ] Bedrock SDK統合
  - [ ] Knowledge Base検索実装
    - [ ] メタデータフィルター適用
    - [ ] Top 10件取得
  - [ ] Claude 4応答生成
    - [ ] プロンプトテンプレート作成
    - [ ] Temperature: 0.3
    - [ ] Max tokens: 4096
  - [ ] 引用情報抽出

**Week 12:**
- [ ] セッション管理実装
  - [ ] 新規セッション作成
  - [ ] セッションタイトル自動生成
  - [ ] 履歴取得
- [ ] DynamoDB統合
  - [ ] メッセージ保存
  - [ ] TTL設定
  - [ ] 履歴取得
- [ ] エラーハンドリング
  - [ ] リトライロジック（Bedrock API）
  - [ ] タイムアウト処理
  - [ ] エラーログ記録
- [ ] 単体テスト作成
  - [ ] Mock Bedrock
  - [ ] DynamoDB操作テスト

**成果物:**
- ✅ RAG Lambda実装完了
- ✅ Knowledge Base連携確認

---

### 3.4 Week 13-14: チャット管理Lambda実装

#### バックエンド実装

**Week 13:**
- [ ] チャット管理API Gateway作成
  - [ ] Cognito Authorizer設定
  - [ ] スロットリング設定: 50 req/sec
- [ ] chat-management-function 実装
  - [ ] セッション一覧取得
  - [ ] セッション詳細取得
  - [ ] セッション削除
  - [ ] メッセージ一覧取得
  - [ ] フィードバック更新（👍👎）

**Week 14:**
- [ ] DynamoDB CRUD操作実装
  - [ ] GSI活用（userId-timestamp-index）
  - [ ] ページネーション実装
  - [ ] TTL確認ロジック
- [ ] 単体テスト作成
- [ ] 統合テスト作成
  - [ ] RAG処理 → チャット管理連携

**成果物:**
- ✅ チャット管理Lambda完成
- ✅ API統合テスト完了

---

### 3.5 Week 15-16: フロントエンド実装

#### チャット画面UI実装

**Week 15:**
- [ ] チャット画面レイアウト作成
  - [ ] サイドバー（セッション一覧）
  - [ ] メインエリア（チャット表示）
  - [ ] 入力エリア
- [ ] セッション管理UI
  - [ ] 新規セッションボタン
  - [ ] セッション一覧表示
  - [ ] セッション選択
  - [ ] 残り日数表示
- [ ] メッセージ表示UI
  - [ ] ユーザーメッセージ
  - [ ] AIメッセージ
  - [ ] タイムスタンプ
  - [ ] ローディング表示

**Week 16:**
- [ ] 引用文書表示UI
  - [ ] 文書名リスト
  - [ ] ダウンロードボタン
  - [ ] ソースURI表示
- [ ] フィードバック機能UI
  - [ ] 👍👎ボタン
  - [ ] フィードバック保存
- [ ] フィルター機能UI
  - [ ] ドキュメントタイプフィルター
  - [ ] 製品フィルター
  - [ ] モデルフィルター
- [ ] リアルタイムメッセージ表示
  - [ ] ストリーミング表示（検討）
  - [ ] 自動スクロール

#### 状態管理・API統合

**Week 16:**
- [ ] Zustand ストア作成
  - [ ] チャット状態管理
  - [ ] セッション状態管理
- [ ] API統合
  - [ ] RAG Query API
  - [ ] セッション管理API
- [ ] エラーハンドリングUI
  - [ ] トースト通知
  - [ ] エラーメッセージ表示
  - [ ] リトライボタン

**成果物:**
- ✅ チャット画面完成
- ✅ 全機能動作確認完了

---

### 3.6 Phase 2 統合テスト（Week 16）

#### テスト項目

**機能テスト:**
- [ ] RAG処理フロー E2E
  - [ ] 質問送信 → 回答表示
  - [ ] 引用文書表示
  - [ ] フィードバック送信
- [ ] セッション管理
  - [ ] 新規セッション作成
  - [ ] セッション切り替え
  - [ ] 履歴取得
- [ ] フィルター機能
  - [ ] メタデータフィルター適用
  - [ ] 検索結果確認

**パフォーマンステスト:**
- [ ] 同時接続20ユーザー負荷テスト
- [ ] レスポンスタイム < 3秒
- [ ] Knowledge Base検索 < 1秒

**セキュリティテスト:**
- [ ] 認証チェック
- [ ] 入力検証
- [ ] XSS対策確認

**UAT（User Acceptance Test）:**
- [ ] 技術者3名による実地テスト
- [ ] フィードバック収集
- [ ] 改善実施

**成果物:**
- ✅ すべてのテスト通過
- ✅ UAT完了
- ✅ Phase 2完了

**Phase 2完了マイルストーン:** Week 16終了時点

---

### 3.7 Phase 2 レビューポイント

#### 完了基準

- [ ] RAGチャット機能が正常に動作する
  - [ ] 質問→回答→引用表示
  - [ ] セッション管理
  - [ ] フィルター機能
- [ ] Knowledge Baseが正しく検索される
- [ ] パフォーマンス要件を満たす
- [ ] セキュリティ要件を満たす
- [ ] UATで合格判定

#### レビュー会議

- **日程:** Week 16最終日
- **参加者:** 開発チーム、プロジェクトオーナー、技術者代表
- **議題:**
  1. Phase 2成果物デモ
  2. テスト結果報告
  3. UAT結果報告
  4. Phase 3への移行判断
  5. 運用開始判断

---

## 4. Phase 3: 新機能開発（3ヶ月）

### 4.1 概要

**開始:** Phase 2完了後  
**期間:** 3ヶ月  
**詳細仕様:** Phase 2完了後に策定

### 4.2 想定機能

#### トラブルシューティング機能

- Bedrock Agent統合
- DB検索Lambda実装
- 現場情報管理
- トラブル分析UI

#### 品質書類チェック機能

- Claude 4 Vision API統合
- 画像処理Lambda実装
- OCR処理
- 良否判定ロジック
- 判定結果UI

### 4.3 Phase 3詳細計画

**策定時期:** Phase 2完了1週間前  
**策定内容:**
- 詳細要件定義
- 技術検証結果
- タスク分解
- スケジュール

---

## 5. マイルストーンとレビューポイント

### 5.1 主要マイルストーン

| マイルストーン | 時期 | 成果物 | 判定基準 |
|--------------|------|--------|---------|
| M1: 環境構築完了 | Week 2 | AWS環境、開発環境 | 環境動作確認 |
| M2: 認証機能完成 | Week 4 | 認証Lambda、認証画面 | 認証フローE2E成功 |
| M3: Phase 1完了 | Week 8 | ホーム画面、WAF設定 | IP制限動作確認 |
| M4: KB構築完了 | Week 10 | Knowledge Base | 検索動作確認 |
| M5: RAG Lambda完成 | Week 12 | RAG処理Lambda | 単体テスト通過 |
| M6: Phase 2完了 | Week 16 | RAGチャット機能 | UAT合格 |
| M7: Phase 3完了 | Phase 2 + 3ヶ月 | 新機能 | UAT合格 |

### 5.2 週次レビュー

**頻度:** 毎週金曜日  
**時間:** 30分  
**参加者:** 開発チーム  
**議題:**
1. 今週の進捗報告
2. 課題・ブロッカー共有
3. 来週の計画確認

### 5.3 Phase終了レビュー

**Phase 1レビュー:**
- 日程: Week 8最終日
- 時間: 2時間
- 参加者: 開発チーム + プロジェクトオーナー

**Phase 2レビュー:**
- 日程: Week 16最終日
- 時間: 2時間
- 参加者: 開発チーム + プロジェクトオーナー + 技術者代表

---

## 6. リスクと対策

### 6.1 技術リスク

| リスク | 影響度 | 発生確率 | 対策 |
|-------|--------|---------|------|
| Bedrock API制限 | 高 | 中 | リトライロジック実装、代替プラン検討 |
| Knowledge Base検索精度 | 高 | 中 | ドキュメント品質向上、プロンプト最適化 |
| パフォーマンス問題 | 中 | 中 | 負荷テスト実施、キャッシュ戦略検討 |
| WAF誤検知 | 中 | 低 | ホワイトリスト調整、ログ監視 |

### 6.2 スケジュールリスク

| リスク | 影響度 | 発生確率 | 対策 |
|-------|--------|---------|------|
| Phase 1遅延 | 高 | 中 | バッファ期間確保、優先度調整 |
| KB構築遅延 | 高 | 中 | ドキュメント準備前倒し、並行作業 |
| テスト工数超過 | 中 | 高 | 自動テスト拡充、早期テスト開始 |
| UAT不合格 | 高 | 低 | 早期ユーザーフィードバック取得 |

### 6.3 その他のリスク

| リスク | 影響度 | 発生確率 | 対策 |
|-------|--------|---------|------|
| 要件変更 | 中 | 中 | 変更管理プロセス確立 |
| リソース不足 | 高 | 低 | 外部リソース確保検討 |
| AWSコスト超過 | 中 | 低 | コスト監視、アラート設定 |

---

## 進捗管理

### 進捗状況

- **Phase 1:** 未着手
- **Phase 2:** 未着手
- **Phase 3:** 未着手

### 次のアクション

1. [ ] 開発キックオフミーティング開催
2. [ ] AWS環境構築開始（Week 1）
3. [ ] 週次レビュー日程調整

---

**最終更新:** 2025-10-02  
**更新者:** Development Team
